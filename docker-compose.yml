# This docker-compose config for ArchiveBox runs the following containers:
#     - ArchiveBox (it creates the initial archive, then sleeps forever to allow commands to be run with exec to add links)
#     - nginx webserver running on https://127.0.0.1:8098
# Usage:
#     docker-compose up -d
#     echo "https://example.com" | docker-compose run archivebox archivebox add
#     docker-compose run archivebox archivebox https://example.com/some/feed.rss
# Documentation:
#     https://github.com/pirate/ArchiveBox/wiki/Docker#docker-compose

version: '3.7'

services:
    archivebox:
        build: .
        image: archivebox:latest
        command: server 0.0.0.0:8000
        stdin_open: true
        tty: true
        environment:
            - USE_COLOR=True
            - SHOW_PROGRESS=False
        volumes:
            - ./data:/data

    nginx:
        image: nginx:alpine
        ports:
            - 443:443
            - 80:80
        volumes:
            - ./etc/nginx/nginx.conf:/etc/nginx/nginx.conf
            - ./data:/var/www
